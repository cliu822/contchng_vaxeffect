"0","df_cont_cov <- df_cont_cov %>%"
"0","  "
"0","              mutate(vax_comm_cat_all = case_when("
"0","                                          is.na(Series_Complete_Pop_Pct)~NA_character_,"
"0","                                          Series_Complete_Pop_Pct<=20~""0%-20%"","
"0","                                          Series_Complete_Pop_Pct<=40~""21%-40%"","
"0","                                          Series_Complete_Pop_Pct<=50~""41%-50%"","
"0","                                          Series_Complete_Pop_Pct<=60~""51%-60%"","
"0","                                          Series_Complete_Pop_Pct<=100~""61%-100%""))"
"0",""
"0","##Make data frame into long"
"0","df_cont_cov_long2 <- df_cont_cov%>%"
"0","                        select(round,p_id,val95_home:val100_all,variant_worry_cat, string_cat,vax_cat, vax_comm_cat_all)%>%  ##Remove continuous versions of variables"
"0","                        select(-orig_all)%>%            ##Remove untruncated contact values"
"0","                        pivot_longer(cols=variant_worry_cat:vax_comm_cat_all, names_to = ""var"",values_to=""val"")%>%"
"0","                        pivot_longer(cols=val95_home:val100_all,names_to=""outcome"", values_to=""contacts"")%>%"
"0","                        mutate(val=as.character(val))"
"0",""
"0","cont_cov_list2 <- split(df_cont_cov_long2,df_cont_cov_long2$outcome)"
"0","##Function for table for time variant variables "
"0","compute_desc_timevar <- function(x){"
"0","                        ##Distribution, proportion and mean and sd contacts by covariates"
"0","                          cov_tab <-x%>%"
"0","                                group_by(round,var,val)%>%"
"0","                                    summarise(n=n(),"
"0","                                    mean=mean(contacts),"
"0","                                    sd = sd(contacts))"
"0","                          "
"0","                          ##Overall mean and sd contacts"
"0","                    ##Overall mean and sd contacts"
"0","                        overall <- x%>%"
"0","                          group_by(round)%>%"
"0","                          summarise(n=2403,"
"0","                                    mean=mean(contacts),"
"0","                                    sd = sd(contacts))"
"0","                        "
"0","                        tab_desc <-bind_rows(overall,cov_tab)%>%"
"0","                          mutate(prop = n/2403,"
"0","                                 lo95 = mean-1.96*(sd/sqrt(n)),"
"0","                                 hi95 = mean+1.96*(sd/sqrt(n)))%>%"
"0","                          select(-sd)%>%"
"0","                          mutate_at(vars(c(""mean"",""lo95"",""hi95"")),round,1)%>%"
"0","                          mutate(mean = paste0(mean,"" ("",lo95,""-"",hi95, "")""),"
"0","                                 n = paste0(n, "" ("", round(prop*100, digits = 0),""%)""))%>%"
"0","                          select(round:val)%>%"
"0","                          pivot_wider(names_from = ""round"",values_from =c(""n"",""mean""))%>%"
"0","                          mutate(var = ifelse(is.na(var),""Overall"",var),"
"0","                                 val = ifelse(!var %in% c(""Overall"")&is.na(val),""Unknown"",val),"
"0","                                 val = ifelse(is.na(val),"""",val))%>%"
"0","                          "
"0","                          mutate(val = factor(val, levels=c("""",""High"",""Med-high"",""Med-low"",""Low"","
"0","                                                            ""Increased greatly"",""Increased slightly"",""No change"",""Decreased slightly"",""Decreased greatly"","
"0","                                                            ""dose0"",""dose1"",""dose2"","
"0","                                                            ""0%-20%"",""21%-40%"",""41%-50%"",""51%-60%"",""61%-100%"",""Unknown"")))%>%"
"0","                          arrange(var,val)%>%"
"0","                          mutate_all(.,~replace_na(.,""-""))%>%"
"0","                          select(var,val, n_r1, mean_r1, n_r2, mean_r2, n_r3, mean_r3, n_r4, mean_r4)"
"0","}"
"0",""
"0","res_desc_timevar <- lapply(cont_cov_list2,compute_desc_timevar)"
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"2","`summarise()` has grouped output by 'round', 'var'. You can override using the `.groups` argument."
"0","names(res_desc_timevar) <- names(cont_cov_list2)"
"0","write.xlsx(res_desc_timevar, ""0_tab/res_desc_timevar_full_v2.xlsx"")"
