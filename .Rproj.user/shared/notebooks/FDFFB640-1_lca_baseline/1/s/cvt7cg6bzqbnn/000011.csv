"0","df_behav_long <- df_behav%>%select(socdist_cat__r1,travess_cat__r1,travnoness_cat__r1,maskcat__r1,vaxcat__r1,transcat__r1)%>%"
"0","  pivot_longer(cols=socdist_cat__r1:transcat__r1, names_to=""var"", values_to=""val"")"
"0",""
"0","tab_behav <- df_behav_long%>%group_by(var,val)%>%"
"0","  summarise(n=n())%>%"
"0","  mutate(prop = round(n/2403, digits=2))%>%"
"0","  mutate(var=factor(var, levels=c(""maskcat__r1"",""socdist_cat__r1"",""travess_cat__r1"",""travnoness_cat__r1"",""vaxcat__r1"",""transcat__r1"")))%>%"
"0","  arrange(var,val)"
"2","`summarise()` has grouped output by 'var'. You can override using the `.groups` argument."
"0","pal <- c(brewer.pal(5,""Blues""),brewer.pal(6,""Greens""),brewer.pal(5,""Purples""),brewer.pal(5,""RdPu""),""#c0c0c0"")"
"0","p1 <- tab_behav%>%"
"0","  ggplot(aes(x=var,y=n,fill=val))+"
"0","  geom_col()+"
"0","  scale_fill_manual(values=pal)+"
"0","  scale_x_discrete("
"0","                  #limits = c(""maskcat__r1"",""socdist_cat__r1"",""travess_cat__r1"",""travnoness_cat__r1"",""vaxcat__r1""))+"
"0","                 "
"0","                  labels=c(""Masking"",""Social distancing"",""Essential travel"",""Nonessential travel"",""Willing to vax"",""Public transport freq""))+"
"0","  theme_bw()+"
"0","  theme(axis.text.x = element_text(angle=15, vjust=1,hjust=0.8))+"
"0","  xlab("""")+ylab(""Number of participants"")+ggtitle(""Distribution of responses to risk mitigation measures at baseline"")"
"0","  "
"0","png(""0_plot/risk_mitigation_distribution.png"",width=8, height=4, units=""in"",res=300)"
"0","p1"
